# SmartWallet
## Диаграммы последовательности
### Добавление и обновление данных
Взаимодействия клиента, сервера и базы данных при запросе на добавление/обновление данных
```mermaid
---
config:
  theme: forest
  look: classic
---

sequenceDiagram
    title Диаграмма последовательности
    actor C as Клиент
    participant S as Сервер
    participant Bd as База данных
    C->>+S: Запрос на изменение/добавление данных
    S ->S: Проверка наличия JWT токена в заголовке и его валидация

    alt Токен не валиден или отсутствует

        S -->>C: 401 Не авторизован
    else Токен валиден

        S ->S: Валидация данных
        opt Данные должны быть уникальными
            S-->>-Bd: Запрос на проверку униккальности
            activate Bd
            Bd-->>-S: Ответ
            activate S
        end
        alt Валидация не пройдена

            S -->>C: 422 необрабатываемый экземпляр
        else Валидация пройдена

            S->>-Bd: Запрос на получение пользовательских данных
            activate Bd
            Bd->>-S: Данные о пользователе
            activate S
            S ->S: Авторизация пользователя
            alt Авторизация не пройдена

                S-->>C: 404 Пользователь не найден
            else Авторизация пройдена

                S-->>-Bd: получение данных
                activate Bd
                Bd-->>-S: Ответ
                activate S
                alt Данные не найдены

                S-->>C: 404 данные не найдены
                else Данные найдены

                S-->>-Bd: изменение/создание данных
                activate Bd
                Bd-->>-S: Ответ
                activate S
                S -->>-C: Ответ 200
                end
            end
        end    
    end
```
### Получение данных
Взаимодействия клиента, сервера и базы данных при запросе данных:
```mermaid
---
config:
  theme: forest
  look: classic
---

sequenceDiagram
    title Диаграмма последовательности
    actor C as Клиент
    participant S as Сервер
    participant Bd as База данных
    C->>+S: Запрос на получение данных
    S ->S: Проверка наличия JWT токена в заголовке и его валидация

    alt Токен не валиден или отсутствует

        S -->>C: 401 Не авторизован
    else Токен валиден

        S->>-Bd: Запрос на получение пользовательских данных
        activate Bd
        Bd->>-S: Данные о пользователе
        activate S
        S ->S: Авторизация пользователя
        alt Авторизация не пройдена

            S-->>C: 404 Пользователь не найден
        else Авторизация пройдена

            S-->>-Bd: получение данных
            activate Bd
            Bd-->>-S: Ответ
            activate S
            alt Данные не найдены

            S-->>C: 404 данные не найдены
            else Данные найдены

            S -->>-C: Ответ 200
            end
        end    
    end
```
### Удаление данных
Взаимодействия клиента, сервера и базы данных при запросе на удаление данных:
```mermaid
---
config:
  theme: forest
  look: classic
---

sequenceDiagram
    title Диаграмма последовательности
    actor C as Клиент
    participant S as Сервер
    participant Bd as База данных
    C->>+S: Запрос на удаление данных
    S ->S: Проверка наличия JWT токена в заголовке и его валидация

    alt Токен не валиден или отсутствует

        S -->>C: 401 Не авторизован
    else Токен валиден

        S->>-Bd: Запрос на получение пользовательских данных
        activate Bd
        Bd->>-S: Данные о пользователе
        activate S
        S ->S: Авторизация пользователя
        alt Авторизация не пройдена

            S-->>C: 404 Пользователь не найден
        else Авторизация пройдена

            S-->>-Bd: получение данных
            activate Bd
            Bd-->>-S: Ответ
            activate S
            alt Данные не найдены

            S-->>C: 404 данные не найдены
            else Данные найдены

            S-->>-Bd: удаление данных
            activate Bd
            Bd-->>-S: Ответ
            activate S
            S -->>-C: Ответ 200
            end
        end    
    end
```

### Регистрация нового пользователя
Взаимодействия клиента, сервера и базы данных при запросе на регистрацию пользователя:
```mermaid
---
config:
  theme: forest
  look: classic
---

sequenceDiagram
    title Диаграмма последовательности
    actor C as Клиент
    participant S as Сервер
    participant Bd as База данных
    C->>+S: Запрос на регистрацию нового пользователя
    S ->S: Валидация данных
    S-->>-Bd: Запрос на проверку униккальности
    activate Bd
    Bd-->>-S: Ответ
    activate S
    alt Валидация не пройдена

        S -->>C: 422 необрабатываемый экземпляр
    else Валидация пройдена

        S->>S: Создание шаблонных областей трат и денежных хранилищ
        S->>-Bd: Запрос на создание пользователя, областей трат и денежных хранилищ
        activate Bd
        Bd->>-S: Ответ
        activate S
        S -->>-C: Ответ 200
    end    
```
